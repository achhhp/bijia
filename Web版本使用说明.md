# 供应商比价软件 - Web版本使用说明

## 软件功能

本软件是供应商比价软件的Web版本，主要功能包括：

1. **多文件上传**：支持上传至少3份报价单（Excel或CSV格式）
2. **自动价格比较**：自动找出每个物料的最低价和对应供应商
3. **供应商中标统计**：统计每个供应商中了哪些低价物料
4. **结果展示**：直观展示分析结果，包括最低价分析和供应商中标统计
5. **报告导出**：支持将分析结果导出为Excel格式的报告

## 系统要求

- Python 3.6 及以上版本
- 所需依赖包：
  - pandas
  - openpyxl（用于Excel文件处理）
  - flask（用于Web服务）
  - werkzeug（Flask的依赖包，用于文件上传处理）

## 安装方法

1. 确保已安装Python 3.6 及以上版本
2. 安装所需依赖包：
   ```bash
   pip install pandas openpyxl flask
   ```
3. 下载以下文件到本地同一目录：
   - `web_app.py`（主程序文件）
   - `templates/index.html`（前端模板文件）

## 运行步骤

1. 在命令行中进入文件所在目录
2. 执行以下命令启动Web服务：
   ```bash
   python web_app.py
   ```
3. 服务启动后，在浏览器中访问：
   ```
   http://localhost:5000
   ```

## 使用方法

### 1. 准备报价单文件

报价单文件需要包含以下列：
- **物料**：物料名称
- **价格**：物料价格

支持的文件格式：
- Excel文件（.xlsx, .xls）
- CSV文件（.csv）

### 2. 上传报价单

1. 在Web界面中，点击"选择报价单文件"按钮
2. 选择至少3份报价单文件
3. 点击"开始分析"按钮

### 3. 查看分析结果

分析完成后，Web界面会显示：

- **最低价分析**：每个物料的最低价和对应供应商
- **供应商中标统计**：每个供应商中标的物料数量和具体物料

### 4. 导出分析报告

点击"导出Excel报告"按钮，系统会生成并下载一个Excel格式的分析报告，包含：
- **最低价分析**工作表：每个物料的最低价和对应供应商
- **供应商中标统计**工作表：每个供应商的中标情况

## 技术实现细节

### 1. 后端实现

- 使用Flask框架创建Web服务
- 使用pandas库处理和分析数据
- 使用tempfile库管理临时文件
- 使用werkzeug库处理文件上传

### 2. 前端实现

- 使用HTML5和CSS3构建界面
- 使用Bootstrap 5进行样式设计，确保界面美观且响应式
- 使用JavaScript和Bootstrap的Tab组件实现结果的标签页切换

### 3. 数据流程

1. 用户上传报价单文件
2. 后端接收并保存上传的文件
3. 后端解析文件，提取物料和价格信息
4. 后端分析每个物料的最低价和对应供应商
5. 后端统计每个供应商的中标情况
6. 后端清理临时文件
7. 后端将分析结果传递给前端
8. 前端展示分析结果
9. 用户可选择导出Excel报告
10. 后端生成Excel报告并提供下载

## 注意事项

1. 报价单文件必须包含"物料"和"价格"两列
2. "价格"列必须包含数字值
3. 建议使用统一的物料名称格式，确保不同供应商的相同物料能够正确匹配
4. 软件会使用文件名作为供应商名称，建议使用清晰的文件名格式
5. 对于大型报价单文件，分析可能需要一定时间，请耐心等待
6. Web服务默认运行在 http://localhost:5000，如需修改端口，请修改 `web_app.py` 文件中的 `app.run()` 函数参数

## 故障排除

### 常见错误及解决方案

1. **文件上传失败**
   - 检查文件大小是否超过限制（默认16MB）
   - 检查文件格式是否支持
   - 检查网络连接是否正常

2. **分析结果为空**
   - 检查是否上传了足够的报价单文件（至少3份）
   - 检查报价单文件是否包含有效的数据
   - 检查报价单文件是否包含"物料"和"价格"列

3. **导出报告失败**
   - 检查网络连接是否正常
   - 检查浏览器下载设置是否正确
   - 检查是否有足够的磁盘空间

4. **Web服务启动失败**
   - 检查是否已安装所有依赖包
   - 检查端口5000是否被占用
   - 检查Python版本是否符合要求

## 示例文件

软件包中包含三个示例报价单文件，可用于测试软件功能：
- `供应商A.xlsx`
- `供应商B.xlsx`
- `供应商C.xlsx`

## 联系方式

如有任何问题或建议，请联系软件开发者。
